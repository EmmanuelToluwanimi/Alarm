<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css"
        integrity="sha384-HzLeBuhoNPvSl5KYnjx0BT+WB0QEEqLprO+NBkkk5gbc67FTaL7XIGa2w1L0Xbgc" crossorigin="anonymous">
    <title>AlarmProject</title>
    <link rel="stylesheet" href="Alarm.css">
</head>

<body class="text-white container-fluid">
    <div class="nav-bar d-none border-bottom">
        <img src="../Images/ago.png" alt="clock" class="ago">
        <div class="nav-list">
            <div class="nav-widget border-bottom pt-2 px-3">Alarm</div>
            <div class="nav-widget border-bottom pt-2 px-3">Clock</div>
            <div class="nav-widget border-bottom pt-2 px-3">StopWatch</div>
        </div>
    </div>

    <!-- Container for Alarm -->

    <div class="alarmbody">
        <img src="agoo.png" alt="clocku" class="agoo mt-2">
        <div class="div1">
            Alarm Clock
        </div>
        <div id="displayTime" class="shadow-lg  mt-3 p-2 rounded">
            <!-- 23:05:34 -->
        </div>
        <div id="displayDate" class="text-white mt-3 shadow p-2 rounded">
            Saturday, November 7, 2020
        </div>
        <p class="mt-3">Set Alarm For</p>
        <div class="select-div text-white">
            <select id="selectHour" class="selecto shadow p-2 rounded">
                <option value="00">00</option>
                <option value="01">01</option>
                <option value="02">02</option>
                <option value="03">03</option>
                <option value="04">04</option>
                <option value="05">05</option>
                <option value="06">06</option>
                <option value="07">07</option>
                <option value="08">08</option>
                <option value="09">09</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">13</option>
                <option value="14">14</option>
                <option value="15">15</option>
                <option value="16">16</option>
                <option value="17">17</option>
                <option value="18">18</option>
                <option value="19">19</option>
                <option value="20">20</option>
                <option value="21">21</option>
                <option value="22">22</option>
                <option value="23">23</option>

            </select>
            :
            <select id="selectMinute" class="selecto shadow p-2 rounded">
                <option value="00">00</option>
                <option value="01">01</option>
                <option value="02">02</option>
                <option value="03">03</option>
                <option value="04">04</option>
                <option value="05">05</option>
                <option value="06">06</option>
                <option value="07">07</option>
                <option value="08">08</option>
                <option value="09">09</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">13</option>
                <option value="14">14</option>
                <option value="15">15</option>
                <option value="16">16</option>
                <option value="17">17</option>
                <option value="18">18</option>
                <option value="19">19</option>
                <option value="20">20</option>
                <option value="21">21</option>
                <option value="22">22</option>
                <option value="23">23</option>
                <option value="24">24</option>
                <option value="24">25</option>
                <option value="24">26</option>
                <option value="24">27</option>
                <option value="24">28</option>
                <option value="24">29</option>
                <option value="24">30</option>
                <option value="24">31</option>
                <option value="24">32</option>
                <option value="24">33</option>
                <option value="24">34</option>
                <option value="24">35</option>
                <option value="24">36</option>
                <option value="24">37</option>
                <option value="24">38</option>
                <option value="24">39</option>
                <option value="24">40</option>
                <option value="24">41</option>
                <option value="24">42</option>
                <option value="24">43</option>
                <option value="24">44</option>
                <option value="24">45</option>
                <option value="24">46</option>
                <option value="24">47</option>
                <option value="24">48</option>
                <option value="24">49</option>
                <option value="24">50</option>
                <option value="24">51</option>
                <option value="24">52</option>
                <option value="24">53</option>
                <option value="24">54</option>
                <option value="24">55</option>
                <option value="24">56</option>
                <option value="24">57</option>
                <option value="24">58</option>
                <option value="24">59</option>
            </select>
        </div>
        <div class="mt-1">
            Snooze Duration :
        </div>
        <select id="snzid" class="selecto mt-2 shadow p-2 rounded">
            <option value="01">01</option>
            <option value="02">02</option>
            <option value="03">03</option>
            <option value="04">04</option>
            <option value="05">05</option>
            <option value="06">06</option>
            <option value="07">07</option>
            <option value="08">08</option>
            <option value="09">09</option>
            <option value="10">10</option>
            <option value="11">11</option>
            <option value="12">12</option>
            <option value="13">13</option>
            <option value="14">14</option>
            <option value="15">15</option>
            <option value="16">16</option>
            <option value="17">17</option>
            <option value="18">18</option>
            <option value="19">19</option>
            <option value="20">20</option>
            <option value="21">21</option>
            <option value="22">22</option>
            <option value="23">23</option>
            <option value="24">24</option>
            <option value="25">25</option>
            <option value="26">26</option>
            <option value="27">27</option>
            <option value="28">28</option>
            <option value="29">29</option>
            <option value="30">30</option>
        </select>

        <div id="countD" class="mt-4 p-2 rounded shadow-lg">00:00:00</div>
        <div class="trigButton mt-4">
            <button class="btn btn-primary btn-lg mr-2" onclick="getAlarm()" id="btn0">Set the Alarm</button>
            <button class="btn btn-danger btn-lg mr-2 mb-3" id="btn1">Stop the Alarm</button>
            <button class="btn btn-warning btn-lg ml-2 mb-3" onclick="getSnooze()" id="btn2">Snooze</button>
        </div>
    </div>

    <audio src="../Audio/50 cent-05-in da club.mp3" id="myAudio"></audio>

</body>

</html>

<script>

    var currentTime;

    // function to displayTime
    setInterval(getTime, 1000);
    function getTime() {
        var currentTime = new Date();
        var dth = currentTime.getHours();
        var dts = currentTime.getSeconds();
        var dtm = currentTime.getMinutes();
        var dt = dth + ':' + dtm + ':' + dts;
        document.getElementById('displayTime').innerHTML = dt;

    }

    // function to displayDate
    function getDate() {
        var cday;
        var cMonth;
        currentTime = new Date()
        var gday = currentTime.getDay();
        var gMonth = currentTime.getMonth();
        var gDate = currentTime.getDate();
        var gYear = currentTime.getFullYear();

        // formatting day
        switch (gday) {
            case 0:
                cday = "Sunday";
                break;
            case 1:
                cday = "Monday";
                break;
            case 2:
                cday = "Tuesday";
                break;
            case 3:
                cday = "Wednesday";
                break;
            case 4:
                cday = "Thursday";
                break;
            case 5:
                cday = "Friday";
                break;
            case 6:
                cday = "Saturday";
        }

        // formatting Month
        switch (gMonth) {
            case 0:
                cMonth = "January";
                break;
            case 1:
                cMonth = "February";
                break;
            case 2:
                cMonth = "March";
                break;
            case 3:
                cMonth = "April";
                break;
            case 4:
                cMonth = "May";
                break;
            case 5:
                cMonth = "June";
                break;
            case 6:
                cMonth = "July";
                break;
            case 7:
                cMonth = "August";
                break;
            case 8:
                cMonth = "September";
                break;
            case 9:
                cMonth = "October";
                break;
            case 10:
                cMonth = "November";
                break;
            case 11:
                cMonth = "December";
        }

        var dDay = cday + ', ' + cMonth + ' ' + gDate + ' ' + gYear;
        document.getElementById('displayDate').innerHTML = dDay;
    }
    getDate();

    changeBackground based on currentTime
    function changeBackground() {
        var dth = new Date().getHours();
        if (dth >= 12 && dth < 20) {
            document.body.style.backgroundImage = "linear-gradient(rgb(0,0,0,0.6),rgb(0,0,0,0.4)), url(afternun.jpg)";
            console.log('work')
        } else if (dth >= 20) {
            document.body.style.backgroundImage = "linear-gradient(rgb(0,0,0,0.6),rgb(0,0,0,0.4)), url(nightvied.jpg)";
            console.log('ikjkij')
        }

    }
    changeBackground();

    // Alarm function
    function getAlarm() {
        var currentTime = new Date();
        var sH = currentTime.getHours();
        var sM = currentTime.getMinutes();
        var xPlay = document.getElementById('myAudio');

        // get the selected value of hour and parsed into an Integer.
        var sHour = document.getElementById('selectHour');
        xy = sHour.selectedIndex;
        sHour = parseInt(sHour.options[xy].text);
        console.log(sHour);

        // get the selected value of minute and parsed into an Integer.
        var sMinute = document.getElementById('selectMinute');
        yz = sMinute.selectedIndex;
        sMinute = parseInt(sMinute.options[yz].text);
        console.log(sMinute);

        // sends hour and minute value as a parameter, which is then calculated.
        calcAlarm(sHour, sMinute);

        // sends hour and minute value as a parameter for countdown.
        xyz(sHour, sMinute);
    }

    // snooze function
    function getSnooze() {
        var currentTime = new Date();
        var sH = currentTime.getHours();
        var sM = currentTime.getMinutes();
        var xPlay = document.getElementById('myAudio');

        var snze = document.getElementById('snzid');
        var sd = snze.selectedIndex;
        var snMinute = parseInt(snze.options[sd].text);
        // console.log(snMinute);

        var bol = new Date();
        bll = bol.getMinutes() + snMinute;
        console.log(bll);
        bol.setMinutes(bll);
        console.log(bol);
        console.log(bol.getMinutes());
        var bb = bol.getHours();
        var bn = bol.getMinutes();

        xPlay.pause();

        // sends hour and minute value as a parameter, which is then calculated.
        calcAlarm(bb, bn);

        // sends hour and minute value as a parameter for countdown.
        xyz(bb, bn);
    }

    // function that gets hrs and mins as a parameter and operates them.
    function calcAlarm(hr, min) {
        var currentTime = new Date();
        var sH = currentTime.getHours();
        var sM = currentTime.getMinutes();
        var xPlay = document.getElementById('myAudio');

        // calculate selected hour and converts it to minute.
        var gg = currentTime.setHours(hr);
        gg = gg - sH;
        gg = new Date(gg);
        gg = gg.getHours() - sH;
        console.log(gg);
        gg = gg * 60;

        // gets value of hour in minute and adds to selected minute,
        // which is then converted to seconds, then to milliseconds.
        var td = (gg + currentTime.setMinutes(min)) - sM;
        tr = new Date(td);
        tx = (gg + tr.getMinutes()) - sM;
        ts = tx * 60;
        tl = ts - currentTime.getSeconds();
        tms = tl * 1000;
        console.log(tx);
        console.log(ts);

        // function to countdown alarm in milliseconds and plays music when time is up.
        var emma = setTimeout((trt) => {
            xPlay.play();
            // alert('WORKING');
            // prompt('WORKING');
        }, tms);

        // function to countdown total seconds of alarm.
        var mt = setInterval((stt) => {
            tl--;
            console.log(tl);

            let bttn2 = document.getElementById('btn2');
            // condition to clearInterval when countdown reaches Zero(0).
            if (tl == 0) {
                clearInterval(mt)
                bttn2.disabled = false;
            } else {
                tl = tl;
                bttn2.disabled = true;
            }

        }, 1000);

        // calls countdown function
        // xyz();

        // displays stop alarm and snooze btn
        document.getElementById('btn1').style.display = 'inline-block';
        document.getElementById('btn2').style.display = 'inline-block';
        document.getElementById('btn0').style.display = 'none';

        // stopalarm function
        document.getElementById('btn1').addEventListener('click', stopAlarm)
        function stopAlarm() {
            document.getElementById('countD').style.display = 'none';
            clearTimeout(emma);
            clearInterval(mt);
            xPlay.pause();
            // displays stop alarm and snooze btn
            document.getElementById('btn1').style.display = 'none';
            document.getElementById('btn2').style.display = 'none';
            document.getElementById('btn0').style.display = 'block';
        }
    }

    // Countdown function
    function xyz(sHou, sMinut) {
        let jkl = document.getElementById('countD');
        jkl.style.display = "block";

        // // get the selected value of hour and parsed into an Integer.
        // var sHou = document.getElementById('selectHour');
        // rt = sHou.selectedIndex;
        // sHou = parseInt(sHou.options[xy].text);
        // console.log(sHou);

        // // get the selected value of minute and parsed into an Integer.
        // var sMinut = document.getElementById('selectMinute');
        // ry = sMinut.selectedIndex;
        // sMinut = parseInt(sMinut.options[yz].text);
        // console.log(sMinut);

        let dt = new Date();
        let sh = dt.setHours(sHou);
        let sm = dt.setMinutes(sMinut);
        let ss = dt.setSeconds(0);
        let cd = dt.getTime();

        let sette = setInterval((ola) => {
            let now = new Date().getTime();
            let tp = cd - now;

            var hours = Math.floor((tp % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            var minutes = Math.floor((tp % (1000 * 60 * 60)) / (1000 * 60));
            var seconds = Math.floor((tp % (1000 * 60)) / 1000);

            if (tp < 0) {
                clearInterval(sette);
                hours = 0;
                minutes = 0;
                seconds = 0;
            }

            jkl.innerHTML = `${hours}h : ${minutes}m : ${seconds}s `;

        }, 1000);

    }

</script>